{"componentChunkName":"component---src-pages-examples-json-json-content-parent-file-id-jsx","path":"/examples/json/10f2a2d1-21d5-528f-ad63-35bf51d51c21/","result":{"data":{"jsonContent":{"id":"44e7361b-7152-5913-bc92-577358a0476f","content":"CREATE CATALOG hive_tudou WITH (\n    'type' = 'hive',\n    'default-database' = 'tudou',\n    'hive-conf-dir' = '/opt/dtstack/hive/conf'\n    ,'hadoop-conf-dir' = '/opt/dtstack/hadoop-2.7.6/etc/hadoop'\n);\n\nCREATE TABLE source\n(\n    id        INT,\n    PROCTIME AS PROCTIME()\n) WITH (\n      'connector' = 'kafka-x'\n      ,'topic' = 'tudou'\n      ,'properties.bootstrap.servers' = 'ip:9092'\n      ,'scan.startup.mode' = 'latest-offset'\n      ,'value.format' = 'json'\n      );\n\nCREATE TABLE sink\n(\n    id          int,\n    user_id     int,\n    name        varchar\n    , PRIMARY KEY (id) NOT ENFORCED  -- 如果定义了，则根据该字段更新。否则追加\n) WITH (\n      'connector' = 'stream-x',\n      'print' = 'true'\n      );\n\ncreate\nTEMPORARY view view_out\n  as\nselect u.id\n     , s.user_id\n     , s.name\nfrom source u\n         left join hive_tudou.tudou.kudu_parquet\n    /*+ OPTIONS('streaming-source.enable'='true',               --SQL Hints方式，需要在confProp中配置table.dynamic-table-options.enabled=true\n        'streaming-source.partition.include' = 'latest',\n        'streaming-source.monitor-interval' = '1 h',\n        'streaming-source.partition-order' = 'partition-name') */\n    FOR SYSTEM_TIME AS OF u.PROCTIME AS s\n                   on u.id = s.id;\n\ninsert into sink\nselect *\nfrom view_out;\n"}},"pageContext":{"id":"44e7361b-7152-5913-bc92-577358a0476f","parent__id":"10f2a2d1-21d5-528f-ad63-35bf51d51c21","__params":{"parent__id":"10f2a2d1-21d5-528f-ad63-35bf51d51c21"}}},"staticQueryHashes":["1197112220","1410458087","527733040","63159454"]}